# Writeups for Over The Wire Web Exploit

> Link to the place to do the challenges: https://overthewire.org/wargames/natas/

# Table of Contents

- [Writeups for Over The Wire Web Exploit](#writeups-for-over-the-wire-web-exploit)
- [Table of Contents](#table-of-contents)
  - [Natas 0](#natas-0)
  - [Natas 1](#natas-1)
  - [Natas 2](#natas-2)
  - [Natas 3](#natas-3)
  - [Natas 4](#natas-4)
  - [Natas 5](#natas-5)
  - [Natas 6](#natas-6)

## Natas 0

```
Username: natas0
Password: natas0
URL:      http://natas0.natas.labs.overthewire.org
```

Here is the clue:

![Clue for Natas 0](images/Clue_0.png)

So we just need to right click the mouse and inspect the page for viewing the flag:

![Flag 0](images/Answer-0.png)

So, the flag is:

```
g9D9cREhslqBKtcA2uocGHPfMZVzeFK6
```

## Natas 1

The details to login the natas 1 are:

```
Username: natas1
Password: g9D9cREhslqBKtcA2uocGHPfMZVzeFK6
URL:      http://natas1.natas.labs.overthewire.org
```

So, with the given clue, I know that the flag is in the source code but we can't inspect the page with rightclicking:

![Clue for Natas 1](images/Clue_1.png)

Instead of rightclicking, we can use the shortcut to inspect the source code:

```
Shift + Control + C
```

Here is the flag after I use the shortcut to inspect:

![Flag 1](images/Answer-1.png)

So, the flag is:

```
h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7
```

## Natas 2

The details to login the natas 2 are:

```
Username: natas2
Password: h4ubbcXrWqsTo7GGnnUMLppXbOogfBZ7
URL:      http://natas2.natas.labs.overthewire.org
```

When entering the page, it said "There is nothing on this page".
So, we have to find another page by first viewing the source code:

![Clue for Natas 2](images/Clue_2.png)

I saw that there is a image in used "files/pixel.png" and I also see the folder "files".
I go to the link http://natas2.natas.labs.overthewire.org/files/ for viewing all the files in that directory and suprisingingly, I saw 2 files:

![Clue 2.1 for Natas 2](images/Clue_2.1.png)

Hmmm, then I saw the file user.txt is suspicious, and click it to view the file:

![Flag for Natas 2](images/Answer-2.png)

There is a small hint that tell all the following information is listed in the format "username:password". I see all the login credentials of natas3 and other people.
So, the flag from the above screenshot is:

```
G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q
```

## Natas 3

The details to login the natas 3 are:

```
Username: natas3
Password: G6ctbMJ5Nb4cbFwhpMPSvxGHhQ7I6W8Q
URL:      http://natas3.natas.labs.overthewire.org
```

When going to the page, there is a small hint is commented in the source code:

![Clue for Natas 3](images/Clue_3.png)

So, if you have experienced enough in doing challenges then you will know this hint refer to the file robots.txt.
Then, I try to go to http://natas3.natas.labs.overthewire.org/robots.txt, and there is a small hint about the directory that won't be displayed or crawled on Google:

![Clue 3.1 for Natas 3 ](images/Clue_2.png)

Then, I access the URL http://natas3.natas.labs.overthewire.org/s3cr3t/, and we can see that there is a users.txt file which store the flag:

![Flag for Natas 3](images/Answer-3.png)

So, the flag from the above screenshot is:

```
tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm
```

## Natas 4

The details to login the natas 4 are:

```
Username: natas4
Password: tKOcJIbzM4lTs8hbCmzn5Zr4434fGZQm
URL:      http://natas4.natas.labs.overthewire.org
```

When I access the page, it appears like this as the hint:

![Clue for Natas 4](images/Clue_4.png)

Which mean that we have to be redirect from the URL http://natas5.natas.labs.overthewire.org/ to this page so that we can view.

In order to do that, we need to use Burp Suit and turn the intercept on. Then, I catch the request:

![Clue 4.1 for Natas 4](images/Clue_4.1.png)

Now I need to change the "Referer" part from :

```
Referer: http://natas4.natas.labs.overthewire.org/index.php
```

to

```
Referer: http://natas5.natas.labs.overthewire.org/index.php
```

Here is the full request after changing:

```
GET /index.php HTTP/1.1
Host: natas4.natas.labs.overthewire.org
Cache-Control: max-age=0
Authorization: Basic bmF0YXM0OnRLT2NKSWJ6TTRsVHM4aGJDbXpuNVpyNDQzNGZHWlFt
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.123 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Referer: http://natas5.natas.labs.overthewire.org/
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Connection: close
```

Then, we can get the flag. So, the flag is:

![Flag for Natas 4](images/Answer-4.png)

So, the flag from the above screenshot is:

```
Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD
```

## Natas 5

The details to login the natas 5 are:

```
Username: natas5
Password: Z0NsrtIkJoKALBCLi5eqFfcRN82Au2oD
URL:      http://natas5.natas.labs.overthewire.org
```

When I first visit the page, I saw the hint require us to log in first:

![Clue for Natas 5](images/Clue_5.png)

Normally, we store the login information as cookies in our personal devices. So, let's check the the cookie that we store for this page:

![Clue 5.1 for Natas 5](images/Clue_5.1.png)

So, we can see that the cookie named loggedin is currently storing value of 0 (Which is usually known for not logged in). Let's change it to 1 (Which is usually known for logged in or positive condition) and we can get the flag after reloading the page:

![Flag for Natas 5](images/Answer-5.png)

So, the flag from the above screenshot is:

```
fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR
```

## Natas 6

The details to login the natas 5 are:

```
Username: natas6
Password: fOIvE0MDtPTgRhqmmvvAOt2EfXR6uQgR
URL:      http://natas6.natas.labs.overthewire.org
```

When I first view the web page, I saw a input field and a link where we can see the source code:

![Clue for Natas 6](images/Clue_6.png)

Then, I view the source code for this file:
![Clue 6.1 for Natas 6](images/Clue_6.1.png)

Then I see that it include a secret.inc file (This is a suspicious name).
I also saw that it need to compare the input we entered in the field and the variable $secret. So, the variable secret maybe is stored in the file secret.inc.
Then, I go to the URL http://natas6.natas.labs.overthewire.org/includes/secret.inc and I can see the variable $secret is defined:

![Clue 6.2 for Natas 6](images/Clue_6.2.png)

Now, I go back to the page where the input field is shown and enter the payload:

```
FOEIUWGHFEEUHOFUOIU
```

Then, I get the flag:

![Flag for Natas 6](images/Answer-6.png)

So, the flag from the above screenshot is:

```
jmxSiH3SP6Sonf8dv66ng8v1cIEdjXWr
```
